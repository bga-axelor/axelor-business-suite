<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.1.xsd">


	<form id="gst-invoice-form" name="invoice-form" title="Invoice"
		model="com.axelor.apps.account.db.Invoice"
		onLoad="action-account-invoice-onload-group"
		onNew="action-account-invoice-onnew-group,action-gst-invoice-onnew-group"
		extension="true">

		<!-- add new method for gst -action-group-gst-invoice-partner-onchange -->
		<extend target="//field[@name='partner']">
			<attribute name="onChange"
				value="action-group-account-invoice-partner-onchange,action-method-invoice-address-str,action-group-gst-invoice-partner-onchange" />
		</extend>


		<extend target="/panel/field[@name='inTaxTotal']">
			<replace>
				<field name="inTaxTotal" css="order-subtotal"
					showTitle="false" colSpan="12">
					<viewer
						depends="exTaxTotal,currency.symbol,taxTotal,netIGST,netSGST,netCGST"><![CDATA[
		           <dl class="dl-horizontal">
		           <dt x-translate>Total W.T.</dt>
		           <dd>{{record.exTaxTotal}} {{record.currency.symbol}}</dd>
		         
<!-- 		          use for  gst  -->

				   <dt x-translate ng-if="record.netIGST">Net IGST</dt>
		           <dd ng-if="record.netIGST" >{{record.netIGST | number : 2}} {{record.currency.symbol}}</dd>

			       <dt x-translate ng-if="record.netSGST" >Net SGST</dt>
		           <dd ng-if="record.netSGST" >{{record.netSGST | number : 2}} {{record.currency.symbol}}</dd>

		           <dt x-translate ng-if="record.netCGST" >Net CGST</dt>
		           <dd ng-if="record.netCGST" >{{record.netCGST | number : 2}} {{record.currency.symbol}}</dd>           

<!-- 		           end gst -->
  <dt x-translate>Total tax</dt>
		           <dd>{{record.taxTotal}} {{record.currency.symbol}}</dd>
		           <dt class="order-subtotal-total" x-translate>Total A.T.I.</dt>
		           <dd class="order-subtotal-total">{{record.inTaxTotal}} {{record.currency.symbol}}</dd>

		         </dl>
		         ]]>
				</viewer>
				</field>
			</replace>
		</extend>

	</form>





	<!-- gst for set default value set -->

	<form title="Create invoice" name="invoice-form-dummy-details"
		model="com.axelor.apps.account.db.Invoice"
		onNew="action-account-invoice-onnew-group,action-gst-invoice-onnew-group"
		onLoad="action-account-invoice-onload-group">
		<field name="partner"
			onChange="action-group-account-invoice-partner-onchange"
			onSelect="action-set-partner-domain" form-view="partner-form"
			grid-view="partner-grid" />


		<button name="btnSubmit" title="Submit"
			onClick="action-method-gst-invoice-get-partner,close" />

	</form>

	<!-- form -wizard for create invoice -->
	<form name="invoice-form-wizard" title="Create invoice"
		model="com.axelor.apps.base.db.Wizard" width="large"
		onNew="action-gst-invoice-line-set-for-wizard">

		<panel>
			<field name="$invoicePartner" field="$invoicePartner"
				title="Contact partner" type="many-to-one"
				target="com.axelor.apps.base.db.Partner"
				onSelect="action-set-partner-domain"
				onChange="action-gst-invoice-calculate-wizard" />
		</panel>

		<panel-related name="$invoiceLines"
			field="$invoiceLines" form-view="invoice-line-form"
			grid-view="invoice-line-grid" title="Invoice Line" colSpan="12"
			type="many-to-many" target="com.axelor.apps.account.db.InvoiceLine"
			canSelect="false" canNew="false" canEdit="false" />
		<panel sidebar="true">
			<button name="confirmBtn" title="Confirm"
				onClick="action-invoice-save-wizard" colSpan="12" width="200px" />
		</panel>


	</form>


	<action-group
		name="action-group-gst-invoice-partner-onchange">
		<action name="action-gst-invoice-partner-contact"
			if="__config__.app.isApp('gst') &amp;&amp; partner" />

		<action name="action-gst-invoice-calculate"
			if="__config__.app.isApp('gst') &amp;&amp; partner  &amp;&amp; invoiceLineList" />
	</action-group>

	<action-method name="action-gst-invoice-partner-contact">
		<call class="com.axelor.apps.gst.web.PartnerController"
			method="setContact" />
	</action-method>

	<action-group name="action-gst-invoice-onnew-group">
		<action name="action-gst-invoice-line-set"  if="__config__.app.isApp('gst')"/>
	</action-group>

	<action-method name="action-gst-invoice-line-set">
		<call class="com.axelor.apps.gst.web.InvoiceController"
			method="setInvoiceLine" />
	</action-method>
	<action-method name="action-gst-invoice-calculate">
		<call class="com.axelor.apps.gst.web.InvoiceController"
			method="calculate" />
	</action-method>

	<!-- For invoice popup -->
	<action-method
		name="action-method-gst-invoice-get-partner">
		<call class="com.axelor.apps.gst.web.ProductController"
			method="setPartnerForInvoice" />
	</action-method>

	<!-- this action use when invoice save from wizard -->
	<action-method name="action-invoice-save-wizard">
		<call class="com.axelor.apps.gst.web.InvoiceController"
			method="saveInvoice" />
	</action-method>

	<action-method
		name="action-gst-invoice-line-set-for-wizard">
		<call class="com.axelor.apps.gst.web.InvoiceController"
			method="setInvoiceLineForWizard" />
	</action-method>
	<action-method name="action-gst-invoice-calculate-wizard">
		<call class="com.axelor.apps.gst.web.InvoiceController"
			method="calculateFoWizard" />
	</action-method>
</object-views>