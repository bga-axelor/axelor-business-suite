<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.1.xsd">

	<grid id="gst-product-grid" name="product-grid" title="Products"
		model="com.axelor.apps.base.db.Product" extension="true"
		orderBy="code,name" edit-icon="true" x-row-height="80">
		<extend target="/toolbar/button[@name='checkDuplicateBtn']">
			<insert position="after">
				<button if="__config__.app.isApp('gst')"
					name="btnCreateInvoice" title="Create Invoice"
					onClick="action-gst-set-invoice-details-popup" />
				<button if="__config__.app.isApp('gst')"
					name="btnCreateInvoice" title="Create Invoice(*)"
					onClick="action-gst-set-invoice-details-wizard" />
			</insert>
		</extend>
		<extend target="//field[@name='name']">
			<insert position="after">
				<field name="hsbn" />
				<field name="gstRate" />
			</insert>
		</extend>

	</grid>




	<form id="gst-product-form" name="product-form" title="Product"
		model="com.axelor.apps.base.db.Product" extension="true">

		<extend target="//field[@name='productCategory']">
			<attribute name="onChange"
				value="group-action-gst-product-categories-change" />
		</extend>


		<extend target="//field[@name='productCategory']">
			<insert position="after">
				<field name="hsbn" if="__config__.app.isApp('gst')" />
			</insert>
		</extend>


		<extend target="//field[@name='autoUpdateSalePrice']">
			<insert position="after">
				<field if="__config__.app.isApp('gst')" hideIf="!sellable"
					name="gstRate" colSpan="12" />
				<field if="__config__.app.isApp('gst')" hideIf="!sellable"
					name="price" colSpan="12" />
			</insert>
		</extend>
	</form>



	<!-- Use for gst -->
	<action-group
		name="group-action-gst-product-categories-change">
		<action name="action-gst-product-set-gstRate"
			if="__config__.app.isApp('gst')" />
	</action-group>

	<action-attrs name="action-gst-product-set-gstRate">
		<attribute name="value" for="gstRate"
			expr="eval:productCategory.getGstRate()" />
	</action-attrs>

	<action-method name="action-gst-set-invoice-line">
		<call class="com.axelor.apps.gst.web.ProductController"
			method="createInvoice" />
	</action-method>

	<action-view name="action-gst-set-invoice-details-popup"
		title="Invoice Details" model="com.axelor.apps.account.db.Invoice">
		<view type="form" name="invoice-form-dummy-details" />
		<view-param name="popup" value="true" />
		<view-param name="show-toolbar" value="false" />
		<view-param name="show-confirm" value="false" />
		<view-param name="popup-save" value="false" />
		<domain>self.operationTypeSelect = 3</domain>
		<context name="_operationTypeSelect" expr="eval:3" />
		<context name="todayDate"
			expr="eval:__config__.app.getTodayDate()" />
		<context name="productIds" expr="eval:_ids" />
	</action-view>

	<!-- create invoice with wizard -->

	<action-view name="action-gst-set-invoice-details-wizard"
		title="Create invoice details" model="com.axelor.apps.base.db.Wizard">
		<view type="form" name="invoice-form-wizard" />
		<context name="productIds" expr="eval:_ids" />
	</action-view>


	<!-- End gst -->


</object-views>
